<!DOCTYPE html>
<html>
<head>
    <title>google classroom</title>
    <style>
        body { margin:0; background: radial-gradient(circle at center, #0f0f0f, #000); display:flex; flex-direction:column; align-items:center; justify-content:center; height:100vh; font-family: Arial,sans-serif; color:#0ff;}
        h1 { text-shadow: 0 0 15px #0ff; }
        canvas { background:#000; border:2px solid #0ff; box-shadow:0 0 20px #0ff; }
        #info { margin-top:10px; text-align:center; }
        button { cursor:pointer; }
        .ai-on { color:#ff00ff; text-shadow:0 0 10px #ff00ff; }
        #gameContainer { display:flex; align-items:flex-start; gap:20px; position:relative; }
        #speedPanel { display:flex; flex-direction:column; align-items:center; background:#000; border:2px solid #0ff; box-shadow:0 0 20px #0ff; padding:15px; border-radius:10px; }
        #speedPanel h2 { margin:0 0 10px 0; color:#0ff; text-shadow:0 0 10px #0ff; }
        #speedPanel button { margin:5px 0; width:80px; padding:6px 0; background:transparent; color:#0ff; border:2px solid #0ff; border-radius:5px; text-shadow:0 0 5px #0ff; transition: all 0.2s; }
        #speedPanel button:hover { background:#0ff; color:#000; box-shadow:0 0 15px #0ff; }
        .speed-selected { background:#0ff; color:#000; box-shadow:0 0 15px #0ff; }
        #gameOverOverlay { position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); color:#ff00ff; display:flex; align-items:center; justify-content:center; flex-direction:column; font-size:2em; display:none; z-index:10; }
        #gameOverOverlay button { margin-top:20px; padding:10px 20px; background:transparent; color:#ff00ff; border:2px solid #ff00ff; border-radius:8px; font-size:0.5em; cursor:pointer; transition: all 0.2s; }
        #gameOverOverlay button:hover { background:#ff00ff; color:#000; box-shadow:0 0 15px #ff00ff; }
    </style>
</head>
<body>

<h1>Snake In james' ass</h1>
<div id="gameContainer">
    <canvas id="game" width="400" height="400"></canvas>
    <div id="speedPanel">
        <h2>Speed</h2>
        <button id="slowBtn">Slow</button>
        <button id="normalBtn" class="speed-selected">Normal</button>
        <button id="fastBtn">Fast</button>
    </div>
</div>
<div id="info">
    <div id="score">Score: 0</div>
    <div id="highScore">High Score: 0</div>
    <div id="aiStatus">AI: OFF</div>
    <button onclick="restartGame()">Restart</button>
</div>
<div id="gameOverOverlay">
    <div id="gameOverText">Game Over! Score: 0</div>
    <button onclick="restartGame()">Restart</button>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const box = 20;
const gridSize = 20;
let snake, direction, food, score, game;
let speed = 120;
let selectedSpeed = speed;
let aiEnabled = false;
let gameStarted = false;

let highScore = localStorage.getItem("neonSnakeHighScore") || 0;
document.getElementById("highScore").innerText = "High Score: " + highScore;

// Speed buttons
document.getElementById("slowBtn").addEventListener("click", () => selectSpeed(200, "slowBtn"));
document.getElementById("normalBtn").addEventListener("click", () => selectSpeed(120, "normalBtn"));
document.getElementById("fastBtn").addEventListener("click", () => selectSpeed(60, "fastBtn"));

function selectSpeed(val, btnId){
    selectedSpeed = val;
    ["slowBtn","normalBtn","fastBtn"].forEach(id => document.getElementById(id).classList.remove("speed-selected"));
    document.getElementById(btnId).classList.add("speed-selected");
}

function initGame() {
    snake = [{x:9*box, y:10*box}];
    direction = "RIGHT";
    food = randomFood();
    score = 0;
    speed = selectedSpeed;
    document.getElementById("score").innerText="Score: 0";
    document.getElementById("gameOverOverlay").style.display="none";
    gameStarted=false;
    draw();
}

function randomFood() {
    return { x: Math.floor(Math.random()*gridSize)*box, y: Math.floor(Math.random()*gridSize)*box };
}

document.addEventListener("keydown", function(e){
    if(e.key === "]") {
        aiEnabled = !aiEnabled;
        document.getElementById("aiStatus").innerText="AI: "+(aiEnabled?"ON":"OFF");
        document.getElementById("aiStatus").className=aiEnabled?"ai-on":"";
    }
    const arrowKeys = ["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"];
    if(arrowKeys.includes(e.key)){
        if(!gameStarted){
            gameStarted=true;
            clearInterval(game);
            game=setInterval(draw,speed);
        }
        if(!aiEnabled){
            if(e.key==="ArrowLeft" && direction!=="RIGHT") direction="LEFT";
            if(e.key==="ArrowUp" && direction!=="DOWN") direction="UP";
            if(e.key==="ArrowRight" && direction!=="LEFT") direction="RIGHT";
            if(e.key==="ArrowDown" && direction!=="UP") direction="DOWN";
        }
    }
});

function collision(head,array){ return array.some(seg=>seg.x===head.x && seg.y===head.y); }

// =======================
// Unbeatable AI (BFS pathfinding)
// =======================
function runAI(){
    const head = snake[0];

    const directions = ["LEFT","RIGHT","UP","DOWN"];
    const moves = directions.map(d=>({dir:d,pos:getNextPosition(d)})).filter(m=>!isDanger(m.pos));

    if(moves.length===0) return; // trapped

    // BFS to find shortest path to food
    const queue = [];
    const visited = Array(gridSize).fill(null).map(()=>Array(gridSize).fill(false));
    queue.push({x: head.x, y: head.y, path: []});
    visited[head.y/box][head.x/box] = true;

    let foundPath = null;

    const bodySet = new Set(snake.map(s=>s.x+","+s.y));

    while(queue.length>0){
        const current = queue.shift();
        if(current.x===food.x && current.y===food.y){
            foundPath = current.path;
            break;
        }
        for(const d of directions){
            const next = {x: current.x, y: current.y};
            if(d==="LEFT") next.x-=box;
            if(d==="RIGHT") next.x+=box;
            if(d==="UP") next.y-=box;
            if(d==="DOWN") next.y+=box;
            if(next.x<0||next.y<0||next.x>=gridSize*box||next.y>=gridSize*box) continue;
            if(bodySet.has(next.x+","+next.y)) continue;
            if(visited[next.y/box][next.x/box]) continue;
            visited[next.y/box][next.x/box]=true;
            queue.push({x:next.x, y:next.y, path:current.path.concat(d)});
        }
    }

    if(foundPath && foundPath.length>0){
        direction = foundPath[0];
    }else{
        // No path to food: move towards tail safely
        const tail = snake[snake.length-1];
        const safeMoves = moves.filter(m=>{
            const dx = Math.abs(m.pos.x-tail.x);
            const dy = Math.abs(m.pos.y-tail.y);
            return dx+dy>0;
        });
        if(safeMoves.length>0) direction = safeMoves[0].dir;
        else direction = moves[0].dir;
    }
}

function getNextPosition(dir){
    let x=snake[0].x, y=snake[0].y;
    if(dir==="LEFT") x-=box;
    if(dir==="RIGHT") x+=box;
    if(dir==="UP") y-=box;
    if(dir==="DOWN") y+=box;
    return {x,y};
}

function isDanger(pos){
    return (pos.x<0 || pos.y<0 || pos.x>=gridSize*box || pos.y>=gridSize*box || collision(pos,snake));
}

function draw(){
    ctx.fillStyle="#000"; ctx.fillRect(0,0,gridSize*box,gridSize*box);

    if(aiEnabled && gameStarted) runAI();

    snake.forEach((seg,i)=>{
        ctx.fillStyle=i===0?"#0ff":"#00aaaa";
        ctx.fillRect(seg.x,seg.y,box,box);
    });

    ctx.fillStyle="#ff00ff"; ctx.fillRect(food.x,food.y,box,box);

    if(!gameStarted) return;

    let snakeX=snake[0].x;
    let snakeY=snake[0].y;
    if(direction==="LEFT") snakeX-=box;
    if(direction==="RIGHT") snakeX+=box;
    if(direction==="UP") snakeY-=box;
    if(direction==="DOWN") snakeY+=box;

    if(snakeX===food.x && snakeY===food.y){
        score++;
        document.getElementById("score").innerText="Score: "+score;
        clearInterval(game);
        game=setInterval(draw,speed);
        food=randomFood();
    } else snake.pop();

    const newHead={x:snakeX,y:snakeY};

    if(isDanger(newHead)){
        clearInterval(game);
        if(score>highScore){ highScore=score; localStorage.setItem("neonSnakeHighScore",highScore); document.getElementById("highScore").innerText="High Score: "+highScore; }
        document.getElementById("gameOverText").innerText="Game Over! Score: "+score;
        document.getElementById("gameOverOverlay").style.display="flex";
        return;
    }

    snake.unshift(newHead);
}

function restartGame(){ clearInterval(game); initGame(); }

initGame();
</script>

</body>
</html>
